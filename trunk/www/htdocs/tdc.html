 <!DOCTYPE html>
<html>
	<head>

		<title>TDC</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script type="text/javascript" src="/tdc/proj4js/lib/proj4js.js"></script>
		<script type="text/javascript" src="/tdc/openlayers/OpenLayers.js"></script> 
		<script type="text/javascript" src="/tdc/jquery/jquery-1.8.1.js"></script>
		<script type="text/javascript" src="/tdc/xmlhttprequest/XMLHttpRequest.js"></script>
		<link rel="stylesheet" href="tdc.css" type="text/css" />
		<script type="text/javascript">

		// EOV vetület proj4-es definíciója. Figyelem: az EPSG adatbázisban hibásan szerepel, a dátumtranszformáció hiányzik belőle!
		Proj4js.defs["EPSG:2370"] = "+title=Hungarian EOV EPSG:2370 +proj=somerc +lat_0=47.14439372222222 +lon_0=19.04857177777778 +x_0=650000 +y_0=200000 +ellps=GRS67 +datum=HD72 +towgs84=57.01,-69.97,-9.29 +units=m +no_defs"

		//MAP fajl eleresi utvonala
		var urlMap = "http://localhost/cgi-bin/mapserv?map=/home/akoel/Projects/tdc/svn/www/htdocs/tdc.map";

		//Vetuletek
		var hd72=new OpenLayers.Projection('EPSG:2370');

		//MAP objektum
		var map;
		var popup;

		//View layer-ed
		var emptyBaseLayer;
		var viewParcelLayer;
		var viewBuildingLayer;
		var viewUnderpassLayer;
		var viewPointLayer;

		//Query layer-es
		var identifyLayer;

		var queryOwnerUnderpassLayer;
		var queryOwnerBuildingLayer;
		var queryOwnerParcelLayer;
		var queryOwnerUnderpassIndividualUnitLayer;
		var queryOwnerBuildingIndividualUnitLayer;

		var queryObjectPointsBuildingLayer;
		var queryObjectPointsBuildingIndividualUnitLayer;
		var queryObjectPointsUnderpassLayer;
		var queryObjectPointsUnderpassIndividualUnitLayer;
		var queryObjectPointsUnderpassSharedUnitLayer;

		var queryProjectonPointParcelLayer;
		var queryProjectionPointsBuildingLayer;


		//Szint megjelenítést választó mezők
		var buildingLevelSelector;
		var underpassLevelSelector;

		var bubbleSwitcher;
		var x3dModelSwitcher;

		//Szint ki-be kapcsolast vezerlo checkbox/ok
		var parcelLayerSwitcher;
		var buildingLayerSwitcher;
		var buildingUnitLayerSwitcher;
		var buildingLevelsLayerSwitcher;
		var underpassLayerSwitcher;
		var underpassUnitLayerSwitcher;
		var underpassLevelsLayerSwitcher;
		var pointLayerSwitcher;

		var foundLayer = false;

		function init() {

			//-------------
			// MAP objektum
			//-------------
			map = new OpenLayers.Map('mapDiv',
			{
				projection: "EPSG:2370",
				maxExtent: new OpenLayers.Bounds(645200, 227760, 645700, 228050),  //Ez pedig a kijelolt telek
				maxResolution: 0.8,
				units: "m"
			});

			//---------
			// Controls
			//---------
			//map.addControl(new OpenLayers.Control.OverviewMap());

			//Layerek ki/be kapcsolasa
			//map.addControl(new OpenLayers.Control.LayerSwitcher()); //A térképen belül
//			map.addControl(new OpenLayers.Control.LayerSwitcher({'div':OpenLayers.Util.getElement('layerSwitcherDiv')}));

			//Leptek-Láb letiltva
			var scaleLine = new OpenLayers.Control.ScaleLine( {bottomOutUnits: ''} );
			map.addControl( scaleLine );

			//pozicio Control
			var posControl = new OpenLayers.Control.MousePosition({'numDigits':2, 'displayProjection': hd72, 'emptyString':''});
			map.addControl( posControl );

			//Meretarany	    
			var scaleControl = new OpenLayers.Control.Scale();
			map.addControl( scaleControl);
	    
			//--------------------------------------------------------------------------------------------
			// A lathatosagi layerek
			//
			//  MapServer -nek kell lennie
			//--------------------------------------------------------------------------------------------

			emptyBaseLayer = new OpenLayers.Layer("",{isBaseLayer: true},{displayInLayerSwitcher: false});

			viewParcelLayer = new OpenLayers.Layer.WMS( 
				"Földrészlet", 
				urlMap,
				{ layers:  "view_parcel", format: 'image/png' },//, selected_nid: null },
				{ isBaseLayer: false, visibility: true, opacity: 0.6, transparent: 'true' }
			);

			viewBuildingLayer = new OpenLayers.Layer.WMS( 
				"Épület", 
				urlMap,
				{ layers:  "view_building", format: 'image/png' },//, selected_nid: null },
				{ isBaseLayer: false, alpha:true, visibility: true, opacity: 1.0, transparent: 'true' }				
			);

			viewUnderpassLayer = new OpenLayers.Layer.WMS( 
				"Aluljáró", 
				urlMap,
				{ layers:  "view_underpass", format: 'image/png' },
				{ isBaseLayer: false, alpha:true, visibility: true, opacity: 1.0, transparent: 'true' }				
			);

			viewPointLayer = new OpenLayers.Layer.WMS( 
				"Pontok", 
				urlMap,
				{ layers:  "view_point", format: 'image/png' },//, visible_building_level: '0.0', selected_nid: null },
				{ isBaseLayer: false, alpha:true, visibility: false, opacity: 1.0, transparent: 'true' }				
			);

			//----------------------------------------------------------------------------------------------------------------
			// Lekerdezo layerek
			//
			// WMS -nek kell lennie
			//---------------------------------------------------------------------------------------------------------------
			//visibility: false - Nem látható
			//displayInLayerSwithcer: false - Nem lesz látható a Layer Swicherben
			//----------------------------------------------------------------------------------------------------------------
			identifyLayer = new OpenLayers.Layer.WMS( 
				"Közös kérés", 
				urlMap,
				{ layers:  "identify_point,identify_building_individual_unit,identify_building,identify_underpass_individual_unit,identify_underpass_shared_unit,identify_underpass,identify_parcel", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);

			queryOwnerParcelLayer = new OpenLayers.Layer.WMS( 
				"query_owner_parcel", 
				urlMap,
				{ layers:  "query_owner_parcel", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryOwnerBuildingLayer= new OpenLayers.Layer.WMS( 
				"query_owner_building", 
				urlMap,
				{ layers:  "query_owner_building", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryOwnerUnderpassLayer= new OpenLayers.Layer.WMS( 
				"query_owner_underpass", 
				urlMap,
				{ layers:  "query_owner_underpass", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryOwnerUnderpassIndividualUnitLayer = new OpenLayers.Layer.WMS( 
				"query_owner_underpass_individual_unit", 
				urlMap,
				{ layers:  "query_owner_underpass_individual_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryOwnerUnderpassSharedUnitLayer = new OpenLayers.Layer.WMS( 
				"query_owner_underpass_shared_unit", 
				urlMap,
				{ layers:  "query_owner_underpass_shared_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryOwnerBuildingIndividualUnitLayer = new OpenLayers.Layer.WMS( 
				"query_owner_building_individual_unit", 
				urlMap,
				{ layers:  "query_owner_building_individual_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);

			queryObjectPointsBuildingLayer= new OpenLayers.Layer.WMS( 
				"query_object_points_building", 
				urlMap,
				{ layers:  "query_object_points_building", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryObjectPointsBuildingIndividualUnitLayer = new OpenLayers.Layer.WMS( 
				"query_object_points_building_individual_unit", 
				urlMap,
				{ layers:  "query_object_points_building_individual_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryObjectPointsUnderpassLayer= new OpenLayers.Layer.WMS( 
				"query_object_points_underpass", 
				urlMap,
				{ layers:  "query_object_points_underpass", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryObjectPointsUnderpassIndividualUnitLayer = new OpenLayers.Layer.WMS( 
				"query_object_points_underpass_individual_unit", 
				urlMap,
				{ layers:  "query_object_points_underpass_individual_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryObjectPointsUnderpassSharedUnitLayer = new OpenLayers.Layer.WMS( 
				"query_object_points_underpass_shared_unit", 
				urlMap,
				{ layers:  "query_object_points_underpass_shared_unit", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);

			queryProjectionPointsParcelLayer= new OpenLayers.Layer.WMS( 
				"query_projection_points_parcel", 
				urlMap,
				{ layers:  "query_projection_points_parcel", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);
			queryProjectionPointsBuildingLayer= new OpenLayers.Layer.WMS( 
				"query_projection_points_building", 
				urlMap,
				{ layers:  "query_projection_points_building", format: 'image/png' },
				{ isBaseLayer: false, visibility: false, opacity: 1.0, transparent: true, displayInLayerSwitcher: false }				
			);

			//Lekérdező layer-ek
			map.addLayer(identifyLayer);

			map.addLayer(queryOwnerParcelLayer);
			map.addLayer(queryOwnerBuildingLayer);
			map.addLayer(queryOwnerUnderpassLayer);
			map.addLayer(queryOwnerUnderpassIndividualUnitLayer);
			map.addLayer(queryOwnerUnderpassSharedUnitLayer);
			map.addLayer(queryOwnerBuildingIndividualUnitLayer);

			map.addLayer(queryObjectPointsBuildingLayer);
			map.addLayer(queryObjectPointsBuildingIndividualUnitLayer);
			map.addLayer(queryObjectPointsUnderpassLayer);
			map.addLayer(queryObjectPointsUnderpassIndividualUnitLayer);
			map.addLayer(queryObjectPointsUnderpassSharedUnitLayer);

			map.addLayer(queryProjectionPointsParcelLayer);
			map.addLayer(queryProjectionPointsBuildingLayer);

			//Megjelenithető layer-ek
			//Fontos a sorrend. A kovetkezo mindig az elozo felett van
			map.addLayer(viewUnderpassLayer);
			map.addLayer(emptyBaseLayer);
			map.addLayer(viewParcelLayer);		
			map.addLayer(viewBuildingLayer);
			map.addLayer(viewPointLayer);


			//==================//
			//				                //
			// Esemenykezeles	   //
			//				               //
			//=================//
	    
			//---------------------------------
			//Kivalasztas esemény
			//---------------------------------
			//
			// Az összes layeren keres
			// Igy tehát, ha egy pontban egymás alatt több layer is található, akkor az mind bekerül a találati listába
			// Késöbb fogom leválogatni hogy melyik találatra van szükségem
			map.events.register("click", map, function(e){
				var getInfoCommonURL=identifyLayer.getFullRequestString({
				REQUEST: "GetFeatureInfo",
				EXCEPTIONS: "application/vnd.ogc.se_xml",
				FORMAT: 'png',
				BBOX: map.getExtent().toBBOX(),
				X: e.xy.x,
				Y: e.xy.y,
				INFO_FORMAT: 'text/html',
				QUERY_LAYERS:  "identify_point,identify_building_individual_unit,identify_building,identify_underpass_individual_unit,identify_underpass_shared_unit,identify_underpass,identify_parcel", //Azok a layer-ek, amikrol infot akarok
				FEATURE_COUNT: 100,   //Azért kell, mert ha pld van egy sokemeletes épület azonos típusú ingatlanokkal egymás alatt, akkor kell az összes találat, hiszen még nem tudom, hogy melyik szintet akarom
				WIDTH: map.size.w,
				HEIGHT: map.size.h });
				OpenLayers.Request.GET({ url: getInfoCommonURL, callback: function(response){ selection(response, e.xy )}});			
			});

		   	 //Terkep merete a maximalisra-Maximum ekkora lehet egy pixel
			map.zoomToMaxExtent();

			//Alapállapotot állítom a mezőket
			resetValues();

		}; //Vége az incializáló függvénynek

		//||||||||||||||||||||||||||||||||||||||||||||||||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||                                               |||||||||
		//|||||||||    Kiemelo fuggveny+azonosítás  |||||||||
		//||||||||                                                |||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||||||||||||||||||||||||||||||||||||||||||
		function selection(response, xy){

			var xmlDoc = $.parseXML( "<block>" + response.responseText + "</block>" );
			var objs = $( $(xmlDoc)[0] ).find("object" );
			var toDiv = "<html><head></head><body>Kivalasztott elemek<br>"
			var identify_name;
			var identify_nid;
			var immovable_type;
			var identify_settlement;
			var identify_hrsz;
			var identify_levels;
			var identify_registered_area;
			var identify_measured_area;

			var building_individual_unit_level;
			var layerToQuery = "";
			var hasSelected = false;

			clearDivs();
	 		clearBaloon();
			clearSelection();

			//A kurzor poziciójának átszámítása vetületi koordinátára
			var projPos = map.getLonLatFromPixel( {x:xy.x, y:xy.y} );

			//Ha kattintottam egy objektumra
			if( objs.length > 0 ){

				//Ha mar van nyitva popup, akkor azt lezarja
				if( popup ){
					map.removePopup(popup);
				}
			
				//Ha a kijelölt objektum más objektummal tulajdoni viszonyban van
				//De ehhez előbb fentről lefele meg kell találni a kijelölt objektumot
				//Például ha egy házra kattintottam és az látható volt a térképen, akkor azt és az azzal kapcsolatos földterületet kell kijelölni  ???????????

				//Jelzem, hogy meg nem volt kivalasztott elem
				hasSelected = false;


				        ///////////////////////////////////////////////////////////////////////////////////
				      ////////////////////                                                       ////////////////////////////////
				    ////////////////////                        POINT                    ////////////////////////////////
				  ////////////////////                                                       ////////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;

					if( identify_name == "sv_survey_point"  && viewPointLayer.getVisibility()){
					
						//Ezek pont specifikus paraméterek, csak itt lehetek biztos benne, hogy léteznek
						identify_point_name = $(objs[ i ]).find("identify_point_name")[0].textContent;
						identify_point_description = $(objs[ i ]).find("identify_point_description")[0].textContent;
						identify_point_quality = $(objs[ i ]).find("identify_point_quality")[0].textContent;
						identify_point_measured_date = $(objs[ i ]).find("identify_point_measured_date")[0].textContent;
						identify_point_dimension = $(objs[ i ]).find("identify_point_dimension")[0].textContent;
						identify_point_x = $(objs[ i ]).find("identify_point_x")[0].textContent;
						identify_point_y = $(objs[ i ]).find("identify_point_y")[0].textContent;
						identify_point_h = $(objs[ i ]).find("identify_point_h")[0].textContent;

						//=================================================
						//=                                                                           =
						//=   Kozvetlen adatok buborekban valo megjelenitese =
						//=                                                                          =
						//================================================

						//Buborék előkészítése	
						var result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Pont</th></tr>";
						result += "<tr><td>Pont megnevezése:</td><td><b>" + identify_point_name + "</b></td></tr>";
						result += "<tr><td>Pontleírás:</td><td><b>" + identify_point_description  + "</b></td></tr>";
						result += "<tr><td>Pont minőség:</td><td><b>" + identify_point_quality  + "</b></td></tr>";
						result += "<tr><td>Dimenzió:</td><td><b>" +  identify_point_dimension  + "</b></td></tr>";
						result += "<tr><td>Mérés időpontja:</td><td><b>" +  identify_point_measured_date  + "</b></td></tr>";
						result += "<tr><td>x:</td><td><b>" +  identify_point_x  + "</b></td></tr>";
						result += "<tr><td>y:</td><td><b>" +  identify_point_y  + "</b></td></tr>";
						if(identify_point_dimension=3){
							result += "<tr><td>h:</td><td><b>" +  identify_point_h  + "</b></td></tr>";
						}
	
						//showBobble( result, projPos );

						//==================================
						//=                                                  =
						//=   Kozvetlen adatok megjelenitese =
						//=                                                 =
						//================================

						document.getElementById( "identifyDataDIV" ).innerHTML = result;

						//Akkor a kijelolest allitja

						viewPointLayer.params.selected_nid =  identify_nid;

						//Jelzem, hogy van kivalasztott elem
						hasSelected = true;
						break
					}
				}

				        ///////////////////////////////////////////////////////////////////////////////////
				      ///////////////////                                                            ///////////////////////////////
				    ///////////////////    UNDERPASS INDIVIDUAL UNIT   ///////////////////////////////
				  ///////////////////                                                           ///////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;				

					        // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					      // / / / /                                                                           / / / / / 
					    // / / / /      Ha üzlet volt és a layer-en latszik                   / / / / /  
					  // / / / /                                                                          / / / / / 
					// / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /  

					if( identify_name == "im_underpass_individual_unit"  &&  viewUnderpassLayer.getVisibility()  &&  underpassLevelsLayerSwitcher.checked && underpassUnitLayerSwitcher.checked ){

						//Ezek aluljáró-üzlet specifikus paraméterek, csak itt lehetek biztos benne, hogy léteznek
						identify_level = $(objs[ i ]).find("identify_level")[0].textContent;
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;

						//Ha  a látható szinten választottam
						if( viewUnderpassLayer.params.visible_underpass_level == identify_level ){

							//=================================================
							//=                                                                           =
							//=   Kozvetlen adatok buborekban valo megjelenitese =
							//=                                                                          =
							//================================================

							//Buborék előkészítése		
							var result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Aluljáró-üzlethelyiség</th></tr>";
							result += "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
							result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
							result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
							result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";
	
							showBobble( result, projPos );

							//==================================
							//=                                                  =
							//=   Kozvetlen adatok megjelenitese =
							//=                                                 =
							//================================

							document.getElementById( "identifyDataDIV" ).innerHTML = result;

							//==============================
							//=                                            =
							//=   Tulajdonosok megjelenitese =
							//=                                           =
							//============================

							//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
							queryOwnerUnderpassIndividualUnitLayer.params.selected_nid=identify_nid;
							queryOwnerUnderpassIndividualUnitLayer.params.visible_underpass_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getOwnerInfo=queryOwnerUnderpassIndividualUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_owner_underpass_individual_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

								//Tulajdonosi viszonyok megjelenitese
								document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;
							}});

							//===================================
							//=                                                    =
							//= 3D objektum Pontok megjelenitese =
							//=                                                   =
							//=================================
							queryObjectPointsUnderpassIndividualUnitLayer.params.selected_nid=identify_nid;
							queryObjectPointsUnderpassIndividualUnitLayer.params.visible_underpass_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getPointInfo=queryObjectPointsUnderpassIndividualUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_object_points_underpass_individual_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 

								//Pontok megjelenitese
								document.getElementById( "objectPointsListDIV" ).innerHTML = response.responseText;
							}});

							//=========================
							//=                                     =
							//=  X3D Létrehozása          =
							//=                                     =
							//=========================

							x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

							//Kijelölés
							viewUnderpassLayer.params.selected_nid =  identify_nid;
							viewUnderpassLayer.params.selected_name = identify_name;

							//Jelzem, hogy van kivalasztott elem
							hasSelected = true;
							break
						}
					}
				}//UNDERPASS INDIVIDUAL UNIT for

				        ///////////////////////////////////////////////////////////////////////////////////
				      ///////////////////                                                            ///////////////////////////////
				    ///////////////////       UNDERPASS SHARED UNIT        ///////////////////////////////
				  ///////////////////                                                           ///////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;				

					        // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					      // / / / /                                                                           / / / / / 
					    // / / / /      Ha üzlet volt és a layer-en latszik                   / / / / /  
					  // / / / /                                                                          / / / / / 
					// / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /  

					if( identify_name == "im_underpass_shared_unit"  &&  viewUnderpassLayer.getVisibility()  &&  underpassLevelsLayerSwitcher.checked && underpassUnitLayerSwitcher.checked ){

						//Ezek aluljáró-közös helyiség specifikus paraméterek, csak itt lehetek biztos benne, hogy léteznek
						identify_level = $(objs[ i ]).find("identify_level")[0].textContent;
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;

						//Ha  a látható szinten választottam
						if( viewUnderpassLayer.params.visible_underpass_level == identify_level ){

							//=================================================
							//=                                                                           =
							//=   Kozvetlen adatok buborekban valo megjelenitese =
							//=                                                                          =
							//================================================

							//Buborék előkészítése	
							var result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Aluljáró-közös-helyiség</th></tr>";
							result += "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
							result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
							result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
							result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";

							showBobble( result, projPos );

							//==================================
							//=                                                  =
							//=   Kozvetlen adatok megjelenitese =
							//=                                                 =
							//================================

							document.getElementById( "identifyDataDIV" ).innerHTML = result;

							//==============================
							//=                                            =
							//=   Tulajdonosok megjelenitese =
							//=                                           =
							//============================

							//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
							queryOwnerUnderpassSharedUnitLayer.params.selected_nid=identify_nid;
							queryOwnerUnderpassSharedUnitLayer.params.visible_underpass_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getOwnerInfo=queryOwnerUnderpassSharedUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_owner_underpass_shared_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

								//Tulajdonosi viszonyok megjelenitese
								document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;
							}});

							//===================================
							//=                                                    =
							//= 3D objektum Pontok megjelenitese =
							//=                                                   =
							//=================================
							queryObjectPointsUnderpassSharedUnitLayer.params.selected_nid=identify_nid;
							queryObjectPointsUnderpassSharedUnitLayer.params.visible_underpass_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getPointInfo=queryObjectPointsUnderpassSharedUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_object_points_underpass_shared_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 
								//Pontok megjelenitese
								document.getElementById( "objectPointsListDIV" ).innerHTML = response.responseText;
							}});

							//=========================
							//=                                     =
							//=  X3D Létrehozása          =
							//=                                     =
							//=========================

							x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

							//Kijelölés
							viewUnderpassLayer.params.selected_nid =  identify_nid;
							viewUnderpassLayer.params.selected_name = identify_name;

							//Jelzem, hogy van kivalasztott elem
							hasSelected = true;
							break
						}
					}
				}//UNDERPASS SHARED UNIT for

						   /////////////////////////////////////////////////////////////////////////////////
				        ////////////////////                                                       ///////////////////////////////
				     ////////////////////                   UNDERPASS               ////////////////////////////////
				   /////////////////////                                                       //////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;
				
					        // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					      // / / / /                                                                           / / / / / 
					    // / / / /       Ha aluljáró volt és a layer-en latszik               / / / / /  
					  // / / / /                                                                           / / / / / 
					// / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					if( identify_name == "im_underpass"  && viewUnderpassLayer.getVisibility() ){

						//Ezek az aluljáró specifikus paraméterei, csak itt lehetek biztos benne, hogy léteznek
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_levels = $(objs[ i ]).find("identify_levels")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;

						//=================================================
						//=                                                                           =
						//=   Kozvetlen adatok buborekban valo megjelenitese =
						//=                                                                          =
						//================================================

						//Buborék előkészítése	
						var result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Aluljáró ingatlan</th></tr>";
						result += "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
						result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
						result += "<tr><td>Szintek száma:</td><td><b>" +  identify_levels  + "</b></td></tr>";
						result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
						result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";

						showBobble( result, projPos );

						//==================================
						//=                                                  =
						//=   Kozvetlen adatok megjelenitese =
						//=                                                 =
						//================================

						document.getElementById( "identifyDataDIV" ).innerHTML = result;

						//===============================
						//=                                             =
						//=   Tulajdonosok megjelenitese  =
						//=                                            =
						//=============================

						//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
						queryOwnerUnderpassLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getOwnerInfo=queryOwnerUnderpassLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_owner_underpass',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

							//Tulajdonosi viszonyok megjelenitese
							document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;
						}});

						//===================================
						//=                                                     =
						//=  3D objektum Pontok megjelenitese =
						//=                                                     =
						//===================================
						queryObjectPointsUnderpassLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getPointInfo=queryObjectPointsUnderpassLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_object_points_underpass',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 

							//Pontok megjelenitese
							document.getElementById( "objectPointsListDIV" ).innerHTML = response.responseText;
						}});

						//=========================
						//=                                     =
						//=  X3D Létrehozása          =
						//=                                     =
						//=========================

						x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

						//Kijelölés
						viewUnderpassLayer.params.selected_nid =  identify_nid;
						viewUnderpassLayer.params.selected_name = identify_name;

						//Jelzem, hogy van kivalasztott elem
						hasSelected = true;
						break
					}
				}//UNDERPASS for











				        ///////////////////////////////////////////////////////////////////////////////////
				      ////////////////////                                                       ////////////////////////////////
				    ////////////////////  BUILDING INDIVIDUAL UNIT   ////////////////////////////////
				  /////////////////////                                                       ///////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;				

					        // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					      // / / / /                                                                           / / / / / 
					    // / / / /      Ha lakás volt és a layer-en latszik a lakás       / / / / /  
					  // / / / /                                                                          / / / / / 
					// / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /  

					if( identify_name == "im_building_individual_unit"  &&  viewBuildingLayer.getVisibility()  &&  buildingLevelsLayerSwitcher.checked && buildingUnitLayerSwitcher.checked ){

						//Ezek társasházi lakás specifikus paraméterek, csak itt lehetek biztos benne, hogy léteznek
						immovable_type = $(objs[ i ]).find("immovable_type")[0].textContent;
						identify_level = $(objs[ i ]).find("identify_level")[0].textContent;
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;

						//Ha  a látható szinten választottam
						if( viewBuildingLayer.params.visible_building_level == identify_level ){

							//=================================================
							//=                                                                           =
							//=   Kozvetlen adatok buborekban valo megjelenitese =
							//=                                                                          =
							//================================================

							//Buborék előkészítése
							var result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Társasházi lakás</th></tr>";
							result += "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
							result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
							result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
							result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";
	
							showBobble( result, projPos );

							//==================================
							//=                                                  =
							//=   Kozvetlen adatok megjelenitese =
							//=                                                 =
							//================================

							document.getElementById( "identifyDataDIV" ).innerHTML = result;

							//==============================
							//=                                            =
							//=   Tulajdonosok megjelenitese =
							//=                                           =
							//============================

							//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
							queryOwnerBuildingIndividualUnitLayer.params.selected_nid=identify_nid;
							queryOwnerBuildingIndividualUnitLayer.params.visible_building_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getOwnerInfo=queryOwnerBuildingIndividualUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_owner_building_individual_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

								//Tulajdonosi viszonyok megjelenitese
								document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;
							}});

							//===================================
							//=                                                    =
							//= 3D objektum Pontok megjelenitese =
							//=                                                   =
							//=================================
							queryObjectPointsBuildingIndividualUnitLayer.params.selected_nid=identify_nid;
							queryObjectPointsBuildingIndividualUnitLayer.params.visible_building_level=identify_level;

							//Owner list query  a kivalasztott objektumrol
							var getPointInfo=queryObjectPointsBuildingIndividualUnitLayer.getFullRequestString({
								REQUEST: "GetFeatureInfo",
								EXCEPTIONS: "application/vnd.ogc.se_xml",
								FORMAT: 'png',
								BBOX: map.getExtent().toBBOX(),
								X: xy.x,
								Y: xy.y,
								INFO_FORMAT: 'text/html',
								QUERY_LAYERS: 'query_object_points_building_individual_unit',
								FEATURE_COUNT: 100,
								WIDTH: map.size.w,
								HEIGHT: map.size.h });

							//A query elküldése
							OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 
								//Pontok megjelenitese
								document.getElementById( "objectPointsListDIV" ).innerHTML = response.responseText;
							}});

							//=========================
							//=                                     =
							//=  X3D Létrehozása          =
							//=                                     =
							//=========================

							x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

							//Kijelölés
							viewBuildingLayer.params.selected_nid =  identify_nid;
							viewBuildingLayer.params.selected_name = identify_name;

							//Jelzem, hogy van kivalasztott elem
							hasSelected = true;
							break
						}
					}
				}//BUILDING INDIVIDUAL UNIT for

						   /////////////////////////////////////////////////////////////////////////////////
				        ////////////////////                                                       ///////////////////////////////
				     ////////////////////                   BUILDING                  ////////////////////////////////
				   /////////////////////                                                       //////////////////////////////
				//////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){

					//Álatlános paraméterek, Ezek már itt is léteznek
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;
				
					        // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					      // / / / /                                                                           / / / / / 
					    // / / / /       Ha ház volt és a layer-en latszik a ház            / / / / /  
					  // / / / /                                                                           / / / / / 
					// / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					if( identify_name == "im_building"  && viewBuildingLayer.getVisibility() ){

						//Ezek az épület specifikus paraméterei, csak itt lehetek biztos benne, hogy léteznek
						immovable_type = $(objs[ i ]).find("immovable_type")[0].textContent;
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_levels = $(objs[ i ]).find("identify_levels")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;

						//=================================================
						//=                                                                           =
						//=   Kozvetlen adatok buborekban valo megjelenitese =
						//=                                                                          =
						//================================================

						//Buborék előkészítése		
						var result = "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
						result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
						result += "<tr><td>Szintek száma:</td><td><b>" + identify_levels + "</b></td></tr>";
						result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
						result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";

						//Ha "2. Foldreszlet hazzal" volt
						if( immovable_type == 2 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' > Épület a földrészlettel </th></tr>" + result;

						//Ha "3. Foldreszlet kulonallo hazzal" volt
						}else if( immovable_type == 3 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' > EÖI-ú épület </th></tr>" + result;

						//Ha "4. Tarsas haz" volt
						}else if( immovable_type == 4 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' > Társasházi ingatlan </th></tr>" + result;

						}

						showBobble( result, projPos );

						//==================================
						//=                                                  =
						//=   Kozvetlen adatok megjelenitese =
						//=                                                 =
						//================================

						document.getElementById( "identifyDataDIV" ).innerHTML = result;

						//===============================
						//=                                             =
						//=   Tulajdonosok megjelenitese  =
						//=                                            =
						//=============================

						//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
						queryOwnerBuildingLayer.params.immovable_type=immovable_type;
						queryOwnerBuildingLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getOwnerInfo=queryOwnerBuildingLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_owner_building',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

							//Tulajdonosi viszonyok megjelenitese
							document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;
						}});

						//===============================
						//=                                              =
						//=  Vetületi Pontok megjelenitese =
						//=                                             =
						//==============================
						queryProjectionPointsBuildingLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getPointInfo=queryProjectionPointsBuildingLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_projection_points_building',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 

							//Pontok megjelenitese
							document.getElementById( "projectionPointsListDIV" ).innerHTML = response.responseText;
						}});

						//===================================
						//=                                                     =
						//=  3D objektum Pontok megjelenitese =
						//=                                                     =
						//===================================
						queryObjectPointsBuildingLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getPointInfo=queryObjectPointsBuildingLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_object_points_building',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 

							//Pontok megjelenitese
							document.getElementById( "objectPointsListDIV" ).innerHTML = response.responseText;
						}});

						//=========================
						//=                                     =
						//=  X3D Létrehozása          =
						//=                                     =
						//=========================

						x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

						//Kijelölés
						viewBuildingLayer.params.selected_nid =  identify_nid;
						viewBuildingLayer.params.selected_name = identify_name;

						//Jelzem, hogy van kivalasztott elem
						hasSelected = true;
						break
					}
				}//BUILDING for


				           //////////////////////////////////////////////////////////////////////////////////
				         ////////////////////                                                       ///////////////////////////////
				      ////////////////////                  PARCEL                        ////////////////////////////////
				   ////////////////////                                                       ////////////////////////////////
				///////////////////////////////////////////////////////////////////////////////////
				for( i = 0; !hasSelected && i< objs.length; i++){
		
					identify_name = $(objs[ i ]).attr("identify_name");
					identify_nid = $(objs[ i ]).find("identify_nid")[0].textContent;				

					          // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
					        // / / / /                                                                                   / / / / / 
					      // / / / /      Ha földrészlet volt és a layer-en latszik a lakás       / / / / /  
					    // / / / /                                                                                   / / / / / 
					  // / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
					// Ha földrészlet volt és látszik a földrészlet (persze ez mindig látszik-de azért mégis vizsgálom)
					if( identify_name == "im_parcel"  && viewParcelLayer.getVisibility() ){

						//Általános paraméterek
						immovable_type = $(objs[ i ]).find("immovable_type")[0].textContent;
						identify_settlement = $(objs[ i ]).find("identify_settlement")[0].textContent;
						identify_hrsz = $(objs[ i ]).find("identify_hrsz")[0].textContent;
						identify_registered_area = $(objs[ i ]).find("identify_registered_area")[0].textContent;
						identify_measured_area = $(objs[ i ]).find("identify_measured_area")[0].textContent;
						identify_cultivation_name = $(objs[ i ]).find("identify_cultivation_name")[0].textContent;

						//Buborék előkészítése	
						var result = "<tr><td>Város:</td><td><b>" + identify_settlement + "</b></td></tr>";
						result += "<tr><td>Helyrajzi szám:</td><td><b>" + identify_hrsz  + "</b></td></tr>";
						result += "<tr><td>Művelési ág:</td><td><b>" + identify_cultivation_name + "</b></td></tr>";
						result += "<tr><td>Nyilvántartott terület:</td><td><b>" + Math.round(identify_registered_area) + "</b> m2</td></tr>";
						result += "<tr><td>Mért terület: </td><td><b>" + Math.round(identify_measured_area) + "</b> m2</td></tr>";

						//Ha "1. Foldreszlet" volt
						if( immovable_type == 1 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' > Földrészlet </th></tr>" + result;

						//Ha "2. Foldreszlet hazzal" volt
						}else if( immovable_type == 2 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' > Földrészlet házzal </th></tr>" + result;

						//Ha "3. Foldreszlet kulonallo hazzal" volt
						}else if( immovable_type == 3 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Földrészlet (EÖI-nal a területén)</th></tr>" + result;

						//Ha "4. Tarsas haz" volt
						}else if( immovable_type == 4 ){

							result = "<table class='IdentifyDataTable'><tr><th align='center' colspan='2' >Földrészlet - társasházi ingatlan</th></tr>" + result;

						}

						showBobble( result, projPos );

						//==================================
						//=                                                  =
						//=   Kozvetlen adatok megjelenitese =
						//=                                                 =
						//================================

						document.getElementById( "identifyDataDIV" ).innerHTML = result;

						//==============================
						//=                                            =
						//=   Tulajdonosok megjelenitese =
						//=                                           =
						//============================

						//Paraméter átadás-csak a kivalasztott lakas tulajdonosait adja vissza
						//Atadom az immovable_type-ot is, mert igy könnyebb az sql select, ha tudom eleve, hogy milyen típusú
						queryOwnerParcelLayer.params.immovable_type=immovable_type;
						queryOwnerParcelLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getOwnerInfo=queryOwnerParcelLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_owner_parcel',
							FEATURE_COUNT: 1000,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getOwnerInfo, callback: function(response){ 

							//Tulajdonosi viszonyok megjelenitese
							document.getElementById( "ownerListDIV" ).innerHTML = response.responseText;

						}});

						//=================================
						//=                                                 =
						//=   Vetületi Pontok megjelenitese   =
						//=                                                =
						//===============================
						queryProjectionPointsParcelLayer.params.selected_nid=identify_nid;

						//Owner list query  a kivalasztott objektumrol
						var getPointInfo=queryProjectionPointsParcelLayer.getFullRequestString({
							REQUEST: "GetFeatureInfo",
							EXCEPTIONS: "application/vnd.ogc.se_xml",
							FORMAT: 'png',
							BBOX: map.getExtent().toBBOX(),
							X: xy.x,
							Y: xy.y,
							INFO_FORMAT: 'text/html',
							QUERY_LAYERS: 'query_projection_points_parcel',
							FEATURE_COUNT: 100,
							WIDTH: map.size.w,
							HEIGHT: map.size.h });

						//A query elküldése
						OpenLayers.Request.GET({ url: getPointInfo, callback: function(response){ 

							//Pontok megjelenitese
							document.getElementById( "projectionPointsListDIV" ).innerHTML = response.responseText;
						}});

						//=========================
						//=                                     =
						//=  X3D Létrehozása          =
						//=                                     =
						//=========================

						x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos );

						//Kijelölés
						viewParcelLayer.params.selected_nid =  identify_nid;

						//Jelzem, hogy van kivalasztott elem
						hasSelected = true;
						break
					}
				}//PARCEL for
			}

			redraw();

		}//selection(

		//||||||||||||||||||||||||||||||||||||||||||||||||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||                                               |||||||||
		//|||||||||        Buborék megjelenítése       |||||||||
		//||||||||                                                |||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||||||||||||||||||||||||||||||||||||||||||
		function showBobble( result, position ){

			if( bubbleSwitcher.checked ){				
				popup = new OpenLayers.Popup.FramedCloud(
					"chick", 
					position,
					null, 
					result,
					null,
					true,
					null
				);

				//Elhelyezi a buborekot-a terkepen
				map.addPopup( popup );
			}
		}

		//||||||||||||||||||||||||||||||||||||||||||||||||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||                                               |||||||||
		//|||||||||   Egy objektum X3D gyártása   |||||||||
		//||||||||                                                |||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||||||||||||||||||||||||||||||||||||||||||
		function x3dOneGenerate( identify_name, identify_nid, immovable_type, xy, projPos ){

			//Egy php script fogja legyartani az x3d fajlt az elkuldott koordinata es kivalasztott objektum alapjan
			$.ajax({
				type: "GET",
				url: "http://localhost/tdc/htdocs/x3d_one_generate.php",
				contentType: "text/html",
				dataType: "html",
				data: { 	selected_name: identify_name, selected_nid: identify_nid, immovable_type: immovable_type, x: xy.x, y: xy.y, lon: projPos.lon, lat: projPos.lat },
				async:false,
				success: x3dOneSuccess,
				error: x3dOneError
			});
		}

		//
		//Sikeres X3D gyártás után
		//
		function x3dOneSuccess( data, status, req ){
			if( status =="success"){				
				//Link létrehozása
				var linkText = "<a id='x3d_one_href' href='" + data + "'>x3d_one_modell</a>";
				document.getElementById( "x3d_one_link_div" ).innerHTML = linkText;
				//Engedélyezi a gombot az X3D megjelenítéshez
				document.getElementById( "x3d_one_selected_button").removeAttribute("disabled");
				//Ha engedélyezem a modell direkt megjelenítését
				if( x3dModelSwitcher.checked ){
					x3dOneOpen();
				}
			}
		}

		//
		//Sikertelen X3D gyártás után
		//
		function x3dOneError( data, status, req ){
			alert( 'Hiba az ajax híváskor: \n' + data.responseText + 'status: ' + status + '\n' + 'req: ' + req.responseText);
		}

		//
		// Kinyit egy 3D megjelenítőt
		//
		function x3dOneOpen(){
			window.location=document.getElementById('x3d_one_href').href; 
		}

		//|||||||||||||||||||||||||||||||||||||||||||||||||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||                                                  |||||||||
		//||||||||| Minden objektumról X3D gyártás |||||||||
		//||||||||                                                   |||||||||
		//|||||||||||||||||||||||||||||||||||||||||||||||||||||
		//||||||||||||||||||||||||||||||||||||||||||||||||||||
		function x3dAllGenerate( ){

			var radius = parseInt( document.getElementById( "x3d_all_radius_field").value );

			//Egy php script fogja legyartani az x3d fajlt az elkuldott koordinata es kivalasztott objektum alapjan
			$.ajax({
				type: "GET",
				url: "http://localhost/tdc/htdocs/x3d_all_generate.php",
				contentType: "text/html",
				dataType: "html",
				data: { 	radius: radius, lon: map.center.lon, lat: map.center.lat },
				async:false,
				success: x3dAllSuccess,
				error: x3dAllError
			});
		}

		//
		//Sikeres X3D gyártás után
		//
		function x3dAllSuccess( data, status, req ){
			if( status =="success"){				
				//Link létrehozása
				var linkText = "<a id='x3d_all_href' href='" + data + "'>x3d_all_modell</a>";
				document.getElementById( "x3d_all_link_div" ).innerHTML = linkText;
				x3dAllOpen();
			}
		}

		//
		//Sikertelen X3D gyártás után
		//
		function x3dAllError( data, status, req ){
			alert( 'Hiba az ajax híváskor: \n' + data.responseText + 'status: ' + status + '\n' + 'req: ' + req.responseText);
		}

		//
		// Kinyit egy 3D megjelenítőt
		//
		function x3dAllOpen(){
			window.location=document.getElementById('x3d_all_href').href; 
		}



	



		//
		// Alapállapotba állítom a rendszert
		//
		function resetValues(){

			//Kezdeti szintek
			var start_building_level = "0";
			var start_underpass_level = "-1";
	
			// HTML objektum-azonosítók
			x3dModelSwitcher = document.getElementById("x3dmodel_switcher");
			bubbleSwitcher = document.getElementById("bubble_switcher");

			underpassLevelSelector = document.getElementById("underpass_level_selection");
			buildingLevelSelector = document.getElementById("building_level_selection");

			parcelLayerSwitcher = document.getElementById("parcel_layer_switcher");
			buildingLayerSwitcher = document.getElementById("building_layer_switcher");
			buildingUnitLayerSwitcher = document.getElementById("building_unit_layer_switcher");
			buildingLevelsLayerSwitcher = document.getElementById("building_levels_layer_switcher");
			underpassLayerSwitcher = document.getElementById("underpass_layer_switcher");
			underpassUnitLayerSwitcher = document.getElementById("underpass_unit_layer_switcher");
			underpassLevelsLayerSwitcher = document.getElementById("underpass_levels_layer_switcher");
			pointLayerSwitcher = document.getElementById("point_layer_switcher");

			//Parameterek a MAP fajlnak, ha WMS layert hasznalok MapServer helyett, mert akkor nem ismeri fel, hogy a parametereket at kell adni

			//Kezdő paraméterek a parcel-nak
			viewParcelLayer.params.selected_nid =  null;

			//Kezdő paraméterek a building layer-nek
			viewBuildingLayer.params.visible_building_level=start_building_level;
			viewBuildingLayer.params.visible_object='3'; 					//3-building, building_levels, building_unit, 2-building, building_levels, 1-building
			viewBuildingLayer.params.selected_nid = null;					//Kiválaszott objektum azonosítója
			viewBuildingLayer.params.selected_name = null;				//Kiválasztott objektum neve: im_building, im_building_levels, im_building_individual_unit, im_building_shared_unit

			//Kezdő paraméterek az underpass layer-nek
			viewUnderpassLayer.params.visible_underpass_level=start_underpass_level;
			viewUnderpassLayer.params.visible_object='3'; 				//3-underpass, underpass_levels, underpass_unit, 2-underpass, underpass_levels, 1-underpass
			viewUnderpassLayer.params.selected_nid=null; 				//Kiválasztott objektum azonositoja
			viewUnderpassLayer.params.selected_name=null;				//Kiválasztott objektum neve: im_underpass, im_underpass_levels, im_underpass_individual_unit, im_underpass_shared_unit

			//Kezdő paraméterek a point view layer-nek
			viewPointLayer.params.visible_building_level=start_building_level;
			viewPointLayer.params.visible_underpass_level=start_underpass_level;
			viewPointLayer.params.selected_nid =  null;

			//Kezdő paraméterek az Identify layernek
			identifyLayer.params.visible_building_level=start_building_level;
			identifyLayer.params.visible_underpass_level=start_underpass_level;
	
			clearDivs();

			//Beállítom az épület szintválasztót földszintre
			for( var i=0; i<buildingLevelSelector.length; i++){

				if( buildingLevelSelector.options[i].value == start_building_level ){
					buildingLevelSelector.selectedIndex=i;
					break;
				}
			}		

			//Beállítom az aluljáró szintválasztót -1
			for( var i=0; i<underpassLevelSelector.length; i++){

				if( underpassLevelSelector.options[i].value == start_underpass_level ){
					underpassLevelSelector.selectedIndex=i;
					break;
				}
			}

			//Beállítom a layer ki-be kapcsoló checkbox-okat
			parcelLayerSwitcher.checked=true;
			buildingLayerSwitcher.checked=true;
			buildingUnitLayerSwitcher.checked=true;
			buildingLevelsLayerSwitcher.checked=true;
			underpassLayerSwitcher.checked=true;
			underpassUnitLayerSwitcher.checked=true;
			underpassLevelsLayerSwitcher.checked=true;
			pointLayerSwitcher.checked=false;
		
		}

		//
		// Törli az információs felhőt
		//
		function clearBaloon(){

			if( popup ){
				map.removePopup(popup);
			}			
		}

		function clearSelection(){         
			viewParcelLayer.params.selected_nid =  null;
			viewBuildingLayer.params.selected_nid =  null;
			viewPointLayer.params.selected_nid =  null;
			viewUnderpassLayer.params.selected_nid =  null;
		}


		//
		// minden réteget újra rajzol
		//
		function redraw(){
			viewPointLayer.redraw(true);
			viewParcelLayer.redraw(true);
			viewBuildingLayer.redraw(true);
			viewUnderpassLayer.redraw(true);
		}

		//
		// Törli az adatokat a DIV-ekből 
		//
		function clearDivs(){
			document.getElementById( "identifyDataDIV" ).innerHTML = "";
			document.getElementById( "ownerListDIV" ).innerHTML = "";
			document.getElementById( "projectionPointsListDIV" ).innerHTML = "";
			document.getElementById( "objectPointsListDIV" ).innerHTML = "";
			document.getElementById( "x3d_one_link_div" ).innerHTML = "";

			//Tiltja a gombot az X3DLinkDIV linkhez
			document.getElementById( "x3d_one_selected_button").setAttribute('disabled','disabled');
		}


		//
		// Saját layer ki/be kapcsoló vezérlése
		//
		function layerSwitcher( checkbox ){
		
			if( checkbox.id == "parcel_layer_switcher" ){
				viewParcelLayer.setVisibility( checkbox.checked );
				viewParcelLayer.redraw( true );
			}else if( checkbox.id == "building_layer_switcher" ){
				viewBuildingLayer.setVisibility( checkbox.checked );
				if( checkbox.checked	 ){
					buildingUnitLayerSwitcher.disabled=false;
					buildingLevelsLayerSwitcher.disabled=false;
				}else{
					buildingUnitLayerSwitcher.disabled=true;
					buildingLevelsLayerSwitcher.disabled=true;
				}
				viewUnderpassLayer.redraw( true );
			}else if( checkbox.id == "building_levels_layer_switcher" ){
				if( checkbox.checked	 ){
					buildingUnitLayerSwitcher.disabled=false;
					if( buildingUnitLayerSwitcher.checked ){
						viewBuildingLayer.params.visible_object='3';
					}else{
						viewBuildingLayer.params.visible_object='2';
					}
				}else{
					buildingUnitLayerSwitcher.disabled=true;
					viewBuildingLayer.params.visible_object='1';
				}
				viewBuildingLayer.redraw( true );
			}else if( checkbox.id == "building_unit_layer_switcher" ){
				if( checkbox.checked	 ){
					viewBuildingLayer.params.visible_object='3';
				}else{
					viewBuildingLayer.params.visible_object='2';
				}
				viewBuildingLayer.redraw( true );


			}else if( checkbox.id == "underpass_layer_switcher" ){
				viewUnderpassLayer.setVisibility( checkbox.checked );
				if( checkbox.checked	 ){
					underpassUnitLayerSwitcher.disabled=false;
					underpassLevelsLayerSwitcher.disabled=false;
				}else{
					underpassUnitLayerSwitcher.disabled=true;
					underpassLevelsLayerSwitcher.disabled=true;
				}
				viewUnderpassLayer.redraw( true );
			}else if( checkbox.id == "underpass_levels_layer_switcher" ){
				if( checkbox.checked	 ){
					underpassUnitLayerSwitcher.disabled=false;
					if( underpassUnitLayerSwitcher.checked ){
						viewUnderpassLayer.params.visible_object='3';
					}else{
						viewUnderpassLayer.params.visible_object='2';
					}
				}else{
					underpassUnitLayerSwitcher.disabled=true;
					viewUnderpassLayer.params.visible_object='1';
				}
				viewUnderpassLayer.redraw( true );
			}else if( checkbox.id == "underpass_unit_layer_switcher" ){
				if( checkbox.checked	 ){
					viewUnderpassLayer.params.visible_object='3';
				}else{
					viewUnderpassLayer.params.visible_object='2';
				}
				viewUnderpassLayer.redraw( true );
			}else if( checkbox.id == "point_layer_switcher" ){
				viewPointLayer.setVisibility( checkbox.checked );

				viewPointLayer.redraw( true );
			}
		}

		//
		// Szintek változtatása
		//
		function levelChange( option ){

			//
			//Épület szintmegjelenítést választó mező
			//		
			if( option.id == "building_level_selection" ){

				//Ha valtoztatom a megjelenítendő épület szintet, akkor kirajzoltatom az aktuálisat
				viewBuildingLayer.params.visible_building_level=option.value;

				//És a pontokat is változtatni kell ennek értelmében
				viewPointLayer.params.visible_building_level=option.value;

				//Pontazonosító paraméterét is változtatni kell
				identifyLayer.params.visible_building_level=option.value;

				viewBuildingLayer.redraw( true );
				viewPointLayer.redraw( true );

			//
			//Aluljáró szintmegjelenítést választó mező
			//
			}else if( option.id == "underpass_level_selection" ){
			
				//Ha valtoztatom a megjelenítendő aluljáró szintet, akkor kirajzoltatom az aktuálisat
				viewUnderpassLayer.params.visible_underpass_level=option.value;

				//És a pontokat is változtatni kell ennek értelmében
				viewPointLayer.params.visible_underpass_level=option.value;

				//Pontazonosító paraméterét is változtatni kell
				identifyLayer.params.visible_underpass_level=option.value;

				viewUnderpassLayer.redraw( true );
				viewPointLayer.redraw( true );
			}
		}

		//
		// Ellenőrzi, hogy csak számok kerülnek-e a mezőbe
		//
		function numbersonly(e, decimal) {
			var key;
			var keychar;
			if (window.event) {
				key = window.event.keyCode;
			}else if (e) {
				key = e.which;
			}else {
				return true;
			}
			keychar = String.fromCharCode(key);
			if ((key==null) || (key==0) || (key==8) ||  (key==9) || (key==13) || (key==27) ) {
				return true;
			}else if ((("0123456789").indexOf(keychar) > -1)) {
				return true;
			}else if (decimal && (keychar == ".")) {
				return true;
			}else
				return false;
		}

    </script>

</head>

<!--<body onLoad="init()"  bgcolor="#FFFFAA" text="#000000">-->
<body onLoad="init()" >

	<table border="0" >

		<!-- Felső, vezérlő szekció -->
		<tr>						
			
			<!-- Térkép -->
			<td class="Map" valign="top">
				<div id="mapDiv" class="Map" ></div>
			</td>

			<!-- Térkép jobb oldalán látható szekció -->
			<td valign="top" align="left" valign="top" rowspan="2"> <!-- Lenyúlik az identify data szekciójába -->
				<table border="0">
					<tr>						
						<td>
							<table border="0" class="ControllerTable">
								<tr><th colspan="3">Beállítások</th></td>
								
								<!-- Buborék engedélyezésének ki/be kapcsolása -->
								<tr><td><input type="checkbox" id="bubble_switcher" value="bubble_switcher" unchecked>	Buborék</td> </tr>

								<!-- 3D model automatikus megjelenítésének ki/be kapcsolása -->
								<tr><td><input type="checkbox" id="x3dmodel_switcher"  value="x3dmodel_switcher" unchecked> 3D modell</td> </tr>
								<tr>
									<td>
										<table border="0"  class="ControllerTable">
				
											<!-- Vetületen megjelenő épületszint vezérlése -->
											<tr>												
												<td>
													<select id="building_level_selection" onchange="levelChange(this)">
														<option value="3">3. Emelet</option>
														<option value="2">2. Emelet</option>
														<option value="1">1. Emelet</option>
														<option value="0">Földszint</option>
														<option value="-1">-1. Szint</option>
														<option value="-2">-2. Szint</option>
													</select>
												</td>
												<td>Vetületi épületszint</td>					
											</tr>
											<!-- Vetületen megjelenő aluljárószint vezérlése -->								
											<tr>
												<td>
													<select id="underpass_level_selection" onchange="levelChange(this)">
														<option value="-1">-1. Szint&nbsp;&nbsp;</option>
														<option value="-2">-2. Szint </option>
														<option value="-3">-3. Szint</option>
													</select>
												</td>
												<td>	Vetületi aluljárószint</td>
											</tr>
										</table>
									<td>
								</tr>
							</table>
						</td>
					<tr>

					<!-- Saját Layer-ek ki/be kapcsolását vezérlő szekció -->
					<tr>
						<td>
								<table  border="0" class="ControllerTable">
									<tr><th colspan="3">Rétegek</th></td>
									<tr><td colspan="2"><input type="checkbox" id="parcel_layer_switcher" value="parcel_layer_switcher" onchange="layerSwitcher(this)" unchecked> Földrészlet</td>	</tr>
									<tr><td colspan="2"><input type="checkbox" id="building_layer_switcher" value="building_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Épület</td></tr>
									<tr><td colspan="1">&nbsp;&nbsp;</td><td><input type="checkbox" id="building_levels_layer_switcher" value="building_levels_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Szintek</td></tr>
									<tr><td colspan="1">&nbsp;&nbsp;</td><td><input type="checkbox" id="building_unit_layer_switcher" value="building_unit_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Lakások</td></tr>
									<tr><td colspan="2"><input type="checkbox" id="underpass_layer_switcher" value="underpass_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Aluljáró</td></tr>
									<tr><td colspan="1">&nbsp;&nbsp;</td><td><input type="checkbox" id="underpass_levels_layer_switcher" value="underpass_levels_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Szintek</td></tr>
									<tr><td colspan="1">&nbsp;&nbsp;</td><td><input type="checkbox" id="underpass_unit_layer_switcher" value="underpass_unit_layer_switcher"  onchange="layerSwitcher(this)" unchecked> Helyiségek</td></tr>
									<tr><td colspan="2"><input type="checkbox" id="point_layer_switcher" value="point_layer_switcher" onchange="layerSwitcher(this)"  unchecked> Pontok</td></tr>
								</table>
						</td>
					</tr>

					<!-- 3D modell szekció -->
					<tr>
						<td>
							<table  class="ControllerTable">
								<tr><th>3D modell</th></tr>
								<tr><td><button type="button" id="x3d_all_radius_button" onclick="x3dAllGenerate( )">3D modell</button> <input type="text" name="radius" id="x3d_all_radius_field" value="20" size="2" onKeyPress="return numbersonly(event, false)"/> m sugarú körben </td></tr>
								<tr><td><button type="button" id="x3d_one_selected_button" onclick="x3dOneOpen()" disabled="disabled" >3D modell</button> a kiválasztott objektumról </tr>
							</table>
						</td>
					</td>
					<tr>
						<td>
							<div id="x3d_one_link_div" style="display:none;"></div>
							<div id="x3d_all_link_div" style="display:none;"></div
						</td>
					</tr>

				</table>
			</td>
		</tr>
		<tr><td colspan="1"><div id="identifyDataDIV" style="border: 0px solid black; font-family: arial; font-size: 12; overflow:auto;"></div></td></tr>		
		<tr><td colspan="2"><div id="ownerListDIV" style="border: 0px solid black; max-height: 100px; overflow:auto;"></div></td></td></tr>
		<tr><td colspan="2"><div id="projectionPointsListDIV" style="border: 0px solid black; max-height:140px; overflow:auto; "></div></td></tr>
		<tr><td colspan="2"><div id="objectPointsListDIV" style="border: 0px solid black; max-height:140px; overflow:auto; "></div></td></tr>
	</table>

</body>
</html>

